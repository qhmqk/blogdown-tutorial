<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Shiny app 開発をスタート" />
<meta property="og:description" content="最短経路で Shiny の概要を理解してデプロイ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/top-page/" />



<meta property="article:published_time" content="2018-01-10T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-01-10T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Shiny app 開発をスタート"/>
<meta name="twitter:description" content="最短経路で Shiny の概要を理解してデプロイ"/>
<meta name="twitter:site" content="@username"/>
<meta name="generator" content="Hugo 0.31.1" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Shiny app 開発をスタート",
  "url": "/top-page/",
  "wordCount": "709",
  "datePublished": "2018-01-10T00:00:00&#43;00:00",
  "dateModified": "2018-01-10T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "qhmqk"
  },
  "keywords": "R, Shiny",
  "description": "最短経路で Shiny の概要を理解してデプロイ"
}
</script>



    <link rel="canonical" href="/top-page/">

    <title>Shiny app 開発をスタート | Shiny クックブック</title>

    <!-- combined, minified CSS -->
    <link href="/css/style.css" rel="stylesheet" integrity="sha384-O8wjsnz02XiyrPxnhfF6AVOv6YLBaEGRCnVF&#43;DL3gCPBy9cieyHcpixIrVyD2JS5" crossorigin="anonymous">

    <link href="/css/dark.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    

    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-51807609-3', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


    

    

  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="/">Home</a>
          
          
          <a class="nav-link" href="/contact/">Contact</a>
          
          
          <a class="nav-link" href="/about/">About</a>
          
          
        </nav>
      </div>
    </div>

    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="/" rel="home">Shiny クックブック</a></h1>
        <p class="lead blog-description">Shiny app 開発のための日本語リファレンス</p>
      </div>
    </header>

    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="/top-page/">Shiny app 開発をスタート</a></h2>
    <p class="blog-post-meta"> Last updated: <time datetime="2018-01-10T00:00:00Z">Wed Jan 10, 2018</time></p>
    <p> By: qhmqk in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/r" rel="category tag">R</a>


<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/shiny" rel="tag">Shiny</a>

</p>
  </header>

  
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#shiny-って何-読み飛ばしてオーケー">Shiny って何？(読み飛ばしてオーケー)</a></li>
<li><a href="#shiny-を始める前のインストール作業">Shiny を始める前のインストール作業</a>
<ul>
<li><a href="#r-をインストール">R をインストール</a></li>
<li><a href="#rstudio-をインストール">RStudio をインストール</a></li>
<li><a href="#shiny-パッケージをインストール">Shiny パッケージをインストール</a></li>
</ul></li>
<li><a href="#shiny-の基本構造とビルド">Shiny の基本構造とビルド</a></li>
<li><a href="#入力ウィジェットを配置">入力ウィジェットを配置</a>
<ul>
<li><a href="#actionbutton">actionButton</a></li>
<li><a href="#actionlink">actionLink</a></li>
<li><a href="#checkboxinput">checkboxInput</a></li>
<li><a href="#checkboxgroupinput">checkboxGroupInput</a></li>
<li><a href="#dateinput">dateInput</a></li>
<li><a href="#daterangeinput">dateRangeInput</a></li>
<li><a href="#fileinput">fileInput</a></li>
<li><a href="#numericinput">numericInput</a></li>
<li><a href="#passwordinput">passwordInput</a></li>
<li><a href="#radiobuttons">radioButtons</a></li>
<li><a href="#selectinput">selectInput</a></li>
<li><a href="#sliderinput">sliderInput</a></li>
<li><a href="#submitbutton">submitButton</a></li>
<li><a href="#textinput">textInput</a></li>
</ul></li>
<li><a href="#サーバでレンダリングして-出力ウィジェットで表示">サーバでレンダリングして、出力ウィジェットで表示</a></li>
<li><a href="#リアクティビティ-reactivity-を定義">リアクティビティ(Reactivity) を定義</a>
<ul>
<li><a href="#もっとも単純な実装">もっとも単純な実装</a></li>
<li><a href="#単純な実装を拡張して-複数入力-複数出力-reactive-関数による計算過程のカプセル化">単純な実装を拡張して、複数入力、複数出力、reactive 関数による計算過程のカプセル化</a></li>
</ul></li>
<li><a href="#レイアウト">レイアウト</a>
<ul>
<li><a href="#パネルによる要素の結合">パネルによる要素の結合</a></li>
<li><a href="#ページの設計">ページの設計</a></li>
<li><a href="#タブメニューとナビゲーションバー">タブメニューとナビゲーションバー</a></li>
</ul></li>
<li><a href="#shiny-アプリケーションの共有-またはサービスとしての立ち上げ">Shiny アプリケーションの共有、またはサービスとしての立ち上げ</a></li>
<li><a href="#まとめ">まとめ</a></li>
<li><a href="#最後に">最後に</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  

  

<h3 id="shiny-って何-読み飛ばしてオーケー">Shiny って何？(読み飛ばしてオーケー)</h3>

<p>R は世界中で広く使用されているプログラミング言語です。Shiny は R のパッケージの一つで、R による分析結果を動的な web アプリケーションとして公開することができます。</p>

<p>R も Shiny もフリーかつオープンソースのソフトウェアとして、開発が進められています。 Rは、多くのプログラミング言語と同様に、Windows、Mac OS、Linuxなどさまざまなプラットフォーム上で動作します。そのため、Shiny による web アプリケーション開発もプラットフォームは問いません。</p>

<p>Shiny を開発しているのは <a href="https://www.rstudio.com/">RStudio Inc.</a> で、メインの開発者は RStudio の CTO である<a href="https://github.com/jcheng5">Joe Cheng氏</a>です。</p>

<p>R での分析結果を動的に web アプリケーションにしたい、web アプリケーションに統計や機械学習を組み合わせたい、そんなニーズにこたえる最高の環境が Shiny です。Shiny のインストールから、アプリケーションの作成までを紹介します。</p>

<h3 id="shiny-を始める前のインストール作業">Shiny を始める前のインストール作業</h3>

<p>Shiny で web アプリケーション開発を始める人の大半はすでに R のユーザかもしれませんが、Shiny が気になって開発環境を整えたい人もいるかもしれません。R はダウンロードしてインストールすればすぐにプログラミングを始めることができます。さらに、統合開発環境として、これ以上ないくらい便利なRStudioをインストールすれば、エディタから Shiny の動作確認までボタン一つでできるようになります。インストール作業は、3つだけで初期設定の煩雑さはありません。</p>

<ol>
<li><p>R をインストール</p></li>

<li><p>RStudio をインストール</p></li>

<li><p>Shiny パッケージをインストール</p></li>
</ol>

<h4 id="r-をインストール">R をインストール</h4>

<p><a href="https://cran.r-project.org/">CRAN(The Comprehensive R Archive Network)</a>からインストーラをダウンロードします。Linux、Mac、Windowsなどのプラットフォームに合わせてバイナリを選択します。</p>

<p>ダウンロードしたR-***.exeを実行し、ウィザードを進めていけば、インストールが完了します。</p>

<h4 id="rstudio-をインストール">RStudio をインストール</h4>

<p><a href="https://www.rstudio.com/products/rstudio/download/">RStudioの公式サイト</a>からインストーラをダウンロードします。フリーのRStudio Desctop Open Source Licenseを選択し、Windwos、Mac、Linux (Ubuntu, Fedora)などのプラットフォームに合わせたバイナリを選択します。</p>

<h4 id="shiny-パッケージをインストール">Shiny パッケージをインストール</h4>

<p>RStudioを起動し、パッケージをインストールします。console枠で、</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">install.packages(<span style="color:#e6db74">&#34;shiny&#34;</span>)</code></pre></div>

<p>を実行すると、Shiny パッケージのインストールが始まります。パッケージをインストール後、Shiny を実行するために以下のコマンドでパッケージをロードします。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">library</span>(shiny)</code></pre></div>

<h3 id="shiny-の基本構造とビルド">Shiny の基本構造とビルド</h3>

<p>Shiny を構成する要素は大きく２つだけ、ユーザーインターフェース(ui)とサーバ(server)です。ユーザーインターフェースにはレイアウトやコントロールの配置を記述し、サーバにはユーザーインターフェースに表示する数値やグラフを計算する処理を記述します。</p>

<p>ディレクトリを作り、ディレクトリの中に app.R というファイルを置いて、<code>runApp()</code>を実行するだけでShinyアプリケーションが実行されます。最もシンプルなapp.R は以下のコードとなります。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">library</span>(shiny)
ui <span style="color:#f92672">&lt;-</span> fluidPage()
server <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(input, output){}
shinyApp(ui <span style="color:#f92672">=</span> ui, server <span style="color:#f92672">=</span> server)</code></pre></div>

<p>このままでは、空のアプリケーションなので、数値入力とヒストグラム表示を追加すると、以下のコードとなります。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">library</span>(shiny)
ui <span style="color:#f92672">&lt;-</span> fluidPage(
    numericInput(inputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n&#34;</span>, <span style="color:#e6db74">&#34;Sample size&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>),
    plotOutput(outputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hist&#34;</span>)
)
server <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(input, output){
    output<span style="color:#f92672">$</span>hist <span style="color:#f92672">&lt;-</span> renderPlot({
        hist(rnorm(input<span style="color:#f92672">$</span>n))
    })
}
shinyApp(ui <span style="color:#f92672">=</span> ui, server <span style="color:#f92672">=</span> server)</code></pre></div>

<p>一つのファイルにまとめて記述するだけでなく、ui.Rとserver.Rという2つのファイルの分けて記述することもできます。その場合も、同様に<code>runApp()</code>でShinyアプリケーションが実行されます。((最初は、ui.Rとserver.Rの２つのファイルを別々に記述するよう設計されていましたが、version 0.10.2からapp.Rにまとめて記述して実行できるようになりました。説明の順序とは逆です。))</p>

<p>2つのファイルに分割した場合は、<code>shinyApp()</code>が不要です。</p>

<p>ここから、必要に応じてコードを追加していきます。</p>

<ul>
<li><p>ユーザーインターフェースにHTMLのタグやJavaScriptを追加</p></li>

<li><p>サーバに統計解析処理と、グラフ描画を追加</p></li>
</ul>

<p>などの処理を記述することができます。</p>

<h3 id="入力ウィジェットを配置">入力ウィジェットを配置</h3>

<p>ui.R または app.R で <code>shinyApp</code> に与える <code>ui</code> に、入力コントロールに示す関数を記述します。ユーザからの入力には、<code>input$&lt;inputId&gt;</code>でアクセスします。</p>

<table>
<thead>
<tr>
<th align="left">入力ウィジェット(図)</th>
<th align="left">関数</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left"></td>
<td align="left"><a href="/actionbutton/"><code>actionButton(inputId, label, icon, ...)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[<code>actionLink(inputId, label, icon, ...)</code>]()</td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/checkboxinput/"><code>checkboxInput(inputId, label, value)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/checkboxgroupinput/"><code>checkboxGroupInput(inputId, label, choices, selected, inline)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/dateinput/"><code>dateInput(inputId, label, value, min, max, format, startview, weekstart, language)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/daterangeinput/"><code>dateRangeInput(inputId, label, start, end, min, max, format, startview, weekstart, language, separator)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/fileinput/"><code>fileInput(inputId, label, multiple, accept)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/numericinput/"><code>numericInput(inputId, label, )</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/passwordinput/"><code>passwordInput(inputId, label, value)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/radiobuttons/"><code>radioButtons(inputId, label, choices, selected, inline)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/selectinput/"><code>selectInput(inputId, label, choices, selected, multiple, selectize, width, size)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/sliderinput/"><code>sliderInput(inputId, label, min, max, value, step, round, format, locate, ticks, animate, width, sep, pre, post)</code></a></td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[<code>submitButton(text, icon)</code>]()</td>
</tr>

<tr>
<td align="left"></td>
<td align="left"><a href="/textinput/"><code>textInput(inputId, label, value)</code></a></td>
</tr>
</tbody>
</table>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">library</span>(shiny)
ui <span style="color:#f92672">&lt;-</span> fixedPage(
  p(actionButton(<span style="color:#e6db74">&#34;actionButton&#34;</span>, <span style="color:#e6db74">&#34;Action!&#34;</span>)),
  p(actionLink(<span style="color:#e6db74">&#34;actionLink&#34;</span>, <span style="color:#e6db74">&#34;Link&#34;</span>)),
  p(checkboxInput(<span style="color:#e6db74">&#34;checkboxInput&#34;</span>, <span style="color:#e6db74">&#34;Check&#34;</span>)),
  p(checkboxGroupInput(<span style="color:#e6db74">&#34;checkboxGroupInput&#34;</span>, <span style="color:#e6db74">&#34;Choice:&#34;</span>,
                              <span style="color:#66d9ef">c</span>(<span style="color:#e6db74">&#34;choice 1&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c1&#34;</span>,
                                <span style="color:#e6db74">&#34;choice 2&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c2&#34;</span>,
                                <span style="color:#e6db74">&#34;choice 3&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c3&#34;</span>))),
  p(dateInput(<span style="color:#e6db74">&#34;dateInput&#34;</span>, <span style="color:#e6db74">&#34;Date:&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-02-29&#34;</span>)),
  p(dateRangeInput(<span style="color:#e6db74">&#34;dateRangeInput&#34;</span>, <span style="color:#e6db74">&#34;Date range:&#34;</span>,
                 start <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2001-01-01&#34;</span>,
                 end   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2010-12-31&#34;</span>)),
  p(fileInput(<span style="color:#e6db74">&#34;fileInput&#34;</span>, <span style="color:#e6db74">&#34;Choose file:&#34;</span>,
            accept <span style="color:#f92672">=</span> <span style="color:#66d9ef">c</span>(
              <span style="color:#e6db74">&#34;text/csv&#34;</span>,
              <span style="color:#e6db74">&#34;text/comma-separated-values,text/plain&#34;</span>,
              <span style="color:#e6db74">&#34;.csv&#34;</span>))),
  p(numericInput(<span style="color:#e6db74">&#34;numericInput&#34;</span>, <span style="color:#e6db74">&#34;Numeric&#34;</span>, <span style="color:#ae81ff">10</span>, min <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, max <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)),
  p(passwordInput(<span style="color:#e6db74">&#34;passwordInput&#34;</span>, <span style="color:#e6db74">&#34;Password:&#34;</span>)),
  p(radioButtons(<span style="color:#e6db74">&#34;radioButtons&#34;</span>, <span style="color:#e6db74">&#34;Choice:&#34;</span>,
                 <span style="color:#66d9ef">c</span>(<span style="color:#e6db74">&#34;choice 1&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c1&#34;</span>,
                   <span style="color:#e6db74">&#34;choice 2&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c2&#34;</span>,
                   <span style="color:#e6db74">&#34;choice 3&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c3&#34;</span>))),
  p(selectInput(<span style="color:#e6db74">&#34;selectInput&#34;</span>, <span style="color:#e6db74">&#34;Choice:&#34;</span>,
                 <span style="color:#66d9ef">c</span>(<span style="color:#e6db74">&#34;choice 1&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c1&#34;</span>,
                   <span style="color:#e6db74">&#34;choice 2&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c2&#34;</span>,
                   <span style="color:#e6db74">&#34;choice 3&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c3&#34;</span>))),
  p(sliderInput(<span style="color:#e6db74">&#34;sliderInput&#34;</span>, <span style="color:#e6db74">&#34;Slide:&#34;</span>, min <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, max <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>, value <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>)),
  p(submitButton(text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Submit&#34;</span>, icon <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, width <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>)),
  p(textInput(<span style="color:#e6db74">&#34;textInput&#34;</span>, <span style="color:#e6db74">&#34;Text:&#34;</span>, <span style="color:#e6db74">&#34;input text&#34;</span>))
)
server <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(input, output){
  
}
shinyApp(ui <span style="color:#f92672">=</span> ui, server <span style="color:#f92672">=</span> server)</code></pre></div>

<h4 id="actionbutton">actionButton</h4>

<p>押すことで何らかのアクションを起こすボタンです。<code>inputId</code>で指定した値は、ボタンが押される前はNULLで、押された後に0になります。押されるたびに、値が1ずつ増加します。ボタンの押下に対応するコードは、serverで<code>observeEvent</code>や<code>eventReactive</code>内に記述します。</p>

<h4 id="actionlink">actionLink</h4>

<p>機能はactionButtonと同じで、表示がHTML上のリンク形式になっています。ボタンとは、幅などの見た目の指定がない点などが異なっています。</p>

<h4 id="checkboxinput">checkboxInput</h4>

<p>クリックでチェックの有無を切り替えるチェックボックスです。値はTRUEとFALSEの論理値になっています。</p>

<h4 id="checkboxgroupinput">checkboxGroupInput</h4>

<p>チェックボックスのグループです。それぞれのチェックボックスは独立していますが、uiでコードを記述するときに、ベクトル指定によってまとめて定義できます。</p>

<h4 id="dateinput">dateInput</h4>

<p>クリックするとカレンダーのウィジェットが開いて、さらにクリックで特定の日付を選択できます。formatで日付の指定ができるようになっています。<code>yyyy-mm-dd</code>で2012年2月29日を選ぶと、<code>2012-02-29</code>となります。ハイフン区切りで、年(y)・月(m)・日(d)を指定します。以下のような、記述が可能です。</p>

<ul>
<li><p><code>yy</code> 世紀の部分がない年(12)</p></li>

<li><p><code>yyyy</code> 世紀もついた年(2012)</p></li>

<li><p><code>mm</code> 前に0を挿入した2桁の月(02)</p></li>

<li><p><code>m</code> 0の挿入がない月(2)</p></li>

<li><p><code>M</code> 月の名前の略記(Feb.)</p></li>

<li><p><code>MM</code> 月の名前(February)</p></li>

<li><p><code>dd</code> 前に0を挿入した2桁の日</p></li>

<li><p><code>d</code> 0の挿入がない日</p></li>

<li><p><code>D</code> 曜日の名前の略記</p></li>

<li><p><code>DD</code> 曜日の名前</p></li>
</ul>

<h4 id="daterangeinput">dateRangeInput</h4>

<p>dateInputが左右に2つ並んでおり、2つの日付から期間を指定します。</p>

<h4 id="fileinput">fileInput</h4>

<p>ファイル選択ダイアログボックスを開きます。ファイルを選択すると、serverにはファイルのpathではなくdataframeが渡されます。dataframeは1行になっており、nameにファイル名、datapathにファイルへのpathが格納されます。</p>

<h4 id="numericinput">numericInput</h4>

<p>数値を入力するテキストボックスで、右側に現時点の数値の大きくしたり小さくしたりするボタンがついています。</p>

<h4 id="passwordinput">passwordInput</h4>

<p>入力した文字列が見えなくなるテキストボックスです。</p>

<h4 id="radiobuttons">radioButtons</h4>

<p>クリックして選択した項目を切り替えるラジオボタンです。</p>

<h4 id="selectinput">selectInput</h4>

<p>プルダウンリストやプルダウンメニュー、ドロップダウンメニューなどの名前で呼ばれるクリックすることで、下側に選択肢が広がり、その中から1つを選択します。英語では、select list controlです。</p>

<h4 id="sliderinput">sliderInput</h4>

<p>ドラッグでバーを左右に動かして数値を指定します。</p>

<h4 id="submitbutton">submitButton</h4>

<p>押すことで、Shinyアプリケーションの状態が更新されるボタンです。actionButtonと見た目は同じですが、submitButtonを配置すると、ボタン押下のタイミングでのみ表示を更新するアプリケーションを作成できます。<strong>actionButtonを使って、submitButtonと全く同じ機能のプログラムを作成することも可能で、より汎用性のあるactionButtonを使うことが推奨されています</strong>。</p>

<h4 id="textinput">textInput</h4>

<p>文字列を入力するテキストボックスです。</p>

<h3 id="サーバでレンダリングして-出力ウィジェットで表示">サーバでレンダリングして、出力ウィジェットで表示</h3>

<p>サーバでレンダリングしたオブジェクトを、出力ウィジェットとしてUIに配置して表示します。レンダリング関数をserverに、出力ウィジェットをuiで定義します。</p>

<table>
<thead>
<tr>
<th align="left">レンダリング関数</th>
<th align="left">出力ウィジェット</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left"><a href="/renderimage/"><code>renderImage</code></a></td>
<td align="left"><code>imageOutput</code></td>
</tr>

<tr>
<td align="left"><a href="/renderplot/"><code>renderPlot(expr, width, height, res, ...)</code></a></td>
<td align="left"><code>plotOutput(outputId, width, height, )</code></td>
</tr>

<tr>
<td align="left"><a href="/renderprint/"><code>renderPrint</code></a></td>
<td align="left"><code>verbatimTextOutput</code></td>
</tr>

<tr>
<td align="left"><a href="/rendertable/"><code>renderTable</code></a></td>
<td align="left"><code>tableOutput</code></td>
</tr>

<tr>
<td align="left"><a href="/rendertext/"><code>renderText</code></a></td>
<td align="left"><code>textOutput</code></td>
</tr>

<tr>
<td align="left"><a href="/renderui/"><code>renderUI</code></a></td>
<td align="left"><code>uiOutput</code>, <code>htmlOutput</code></td>
</tr>

<tr>
<td align="left"><code>DT::renderDataTable</code></td>
<td align="left"><code>dataTableOutput</code></td>
</tr>

<tr>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>

<h3 id="リアクティビティ-reactivity-を定義">リアクティビティ(Reactivity) を定義</h3>

<p>入力ウィジェットでユーザが何らかの操作を行い、サーバでレンダリングして出力ウィジェットで表示するまでの処理の部分を、Shiny ではリアクティブプログラミングで実現します。R を用いたデータ解析ではあまり馴染みのない言葉ですが、基本的な考え方は難しくありません。</p>

<h4 id="もっとも単純な実装">もっとも単純な実装</h4>

<p>入力と出力を直接 server で定義した関数で結ぶ構造がもっとも単純です。最初に示した数値入力とヒストグラムは、この構造になっています。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">numericInput(inputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n&#34;</span>, <span style="color:#e6db74">&#34;Sample size&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>),
plotOutput(outputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hist&#34;</span>)</code></pre></div>

<p>ユーザが数値を入力するたびに、server では<code>input$n</code>の値が更新されます。<code>output$hist</code>の値が更新されるたびに、<code>plotOutput</code>でプロットを再描画します。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">output<span style="color:#f92672">$</span>hist <span style="color:#f92672">&lt;-</span> renderPlot({
    hist(rnorm(input<span style="color:#f92672">$</span>n))
})</code></pre></div>

<p>server では<code>renderPlot</code>により、<code>input$n</code>を引数として直接<code>output$hist</code>の値を変化させる構造になっています。入力と出力の間が関数のみなので、この形がもっとも単純な実装です。</p>

<h4 id="単純な実装を拡張して-複数入力-複数出力-reactive-関数による計算過程のカプセル化">単純な実装を拡張して、複数入力、複数出力、reactive 関数による計算過程のカプセル化</h4>

<p>入力をサンプルサイズと、幅の2つにします。出力は、先ほどと同様のヒストグラムです。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># ui</span>
numericInput(inputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n&#34;</span>, <span style="color:#e6db74">&#34;Sample size&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>),
numericInput(inputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#e6db74">&#34;Breaks&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>),
plotOutput(outputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hist&#34;</span>)</code></pre></div>

<p>サーバでは、<code>input$n</code>と<code>input$b</code>の値から、ヒストグラムを作成し、<code>renderPlot</code>で出力オブジェクトを生成します。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># server</span>
output<span style="color:#f92672">$</span>hist <span style="color:#f92672">&lt;-</span> renderPlot({
    hist(rnorm(input<span style="color:#f92672">$</span>n), breaks <span style="color:#f92672">=</span> input<span style="color:#f92672">$</span>b)
})</code></pre></div>

<p><code>renderPlot</code>は、<code>input$n</code>または<code>input$b</code>のどちらかの値が変わるたびに再度実行されて、表示が更新されます。</p>

<p>次に、一つの入力に対して、複数の出力を実現します。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># ui</span>
numericInput(inputId <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n&#34;</span>, <span style="color:#e6db74">&#34;Factorial of&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, min <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, max <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
textOutput(<span style="color:#e6db74">&#34;factorial_n&#34;</span>)
textOutput(<span style="color:#e6db74">&#34;factorial_n_inv&#34;</span>)</code></pre></div>

<p><code>numericInput</code>で入力した値の階乗、階乗の逆数の2つの値を計算して出力します。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># server</span>
output<span style="color:#f92672">$</span>factorial_n <span style="color:#f92672">&lt;-</span> renderText({<span style="color:#66d9ef">gamma</span>(input<span style="color:#f92672">$</span>n)})
output<span style="color:#f92672">$</span>factorial_n_inv <span style="color:#f92672">&lt;-</span> renderText({ <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> <span style="color:#66d9ef">gamma</span>(input<span style="color:#f92672">$</span>n)})</code></pre></div>

<p>入力 n の値が更新されるたびに、2つの出力が更新される単純なリアクティビティを定義しました。見ると明らかなように、<code>renderText</code>内で<code>gamma()</code>を実行しており、入力が変化するたびに<code>gamma()</code>を2回実行することになります。入力から計算した値を、複数の出力で使う、あるいは中間変数とする場合に使用するのが<code>reactive</code>関数です。</p>

<p>Shiny のリアクティビティを定義するときに必要となるリアクティブプログラミングでは、中間変数そのものをサーバでは定義しません(できません)。そのため、<code>reactive</code>で、<code>gamma()</code>の計算を、入力変化のたびに毎回再計算される関数として定義します。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># server</span>
current_fact <span style="color:#f92672">&lt;-</span> reactive({<span style="color:#66d9ef">gamma</span>(input<span style="color:#f92672">$</span>n)})

output<span style="color:#f92672">$</span>factorial_n <span style="color:#f92672">&lt;-</span> renderText(current_fact())
output<span style="color:#f92672">$</span>factorial_n_inv <span style="color:#f92672">=</span> renderText({ <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> current_fact()})</code></pre></div>

<p><code>current_fact</code>は、入力が変化するたびに実行する計算をカプセル化したものになります。このカプセル化により、<code>gamma()</code>の実行は1回で済むようになります。</p>

<h3 id="レイアウト">レイアウト</h3>

<p>Shiny のレイアウトは、3段階に分けて考えます。</p>

<ol>
<li><p>パネルによる要素の結合</p></li>

<li><p>ページの設計</p></li>

<li><p>タブメニューとナビゲーションバー</p></li>
</ol>

<h4 id="パネルによる要素の結合">パネルによる要素の結合</h4>

<p>入力や出力UIを一つの要素にまとめる場合に、パネル関数を使用します。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">wellPanel(
    actionButton(<span style="color:#e6db74">&#34;actionButton&#34;</span>, <span style="color:#e6db74">&#34;Action!&#34;</span>),
    checkboxInput(<span style="color:#e6db74">&#34;checkboxInput&#34;</span>, <span style="color:#e6db74">&#34;Check&#34;</span>)
)</code></pre></div>

<h4 id="ページの設計">ページの設計</h4>

<p>パネルを含む各要素を、レイアウト関数を用いてページ内に配置します。</p>

<ul>
<li>fluidRow()</li>
</ul>

<p>幅が可変の行を設定します。行中の列要素が<code>column</code>です。Bootstrapによるデザインでは、一行の幅を12として、各列の<code>width</code>, <code>offset</code>を指定します。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    fluidRow(column(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>), cokumin(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)),
    fluidRow(column(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>))
)</code></pre></div>

<ul>
<li>flowLayout()</li>
</ul>

<p>要素を順に横に並べます。表示する幅に応じて、改行されて配置されます。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    flowLayout(
        <span style="color:#75715e"># object 1,</span>
        <span style="color:#75715e"># object 2,</span>
        <span style="color:#75715e"># object 3</span>
    )
)</code></pre></div>

<ul>
<li>sidebarLayout()</li>
</ul>

<p>1つのページをサイドパネル(<code>sidebarPanel</code>)とメインパネル(<code>mainPanel</code>)に分割するレイアウトです。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    sidebarLayout(
        sidebarPanel(),
        mainPanel()
    )
)</code></pre></div>

<ul>
<li>splitLayout()</li>
</ul>

<p>一つのページを縦に分割するレイアウトです。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    splitLayout(
        <span style="color:#75715e"># object 1,</span>
        <span style="color:#75715e"># object 2</span>
    )
)</code></pre></div>

<ul>
<li>verticalLayout()</li>
</ul>

<p>要素を縦に配置していくレイアウトです。</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    verticalLayout(
        <span style="color:#75715e"># object 1,</span>
        <span style="color:#75715e"># object 2,</span>
        <span style="color:#75715e"># object 3</span>
    )
)</code></pre></div>

<h4 id="タブメニューとナビゲーションバー">タブメニューとナビゲーションバー</h4>

<ul>
<li>タブ</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    tabsetPanel(
        tabPanel(<span style="color:#e6db74">&#34;tab 1&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>),
        tabPanel(<span style="color:#e6db74">&#34;tab 2&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>),
        tabPanel(<span style="color:#e6db74">&#34;tab 3&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>)
    )
)</code></pre></div>

<ul>
<li>ナビゲーションリスト</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    nablistPanel(
        tabPanel(<span style="color:#e6db74">&#34;tab 1&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>),
        tabPanel(<span style="color:#e6db74">&#34;tab 2&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>),
        tabPanel(<span style="color:#e6db74">&#34;tab 3&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>)
    )
)</code></pre></div>

<ul>
<li>ナビゲーションページ</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ui <span style="color:#f92672">&lt;-</span> fluidPage(
    navbarPage(
        tabPanel(<span style="color:#e6db74">&#34;tab 1&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>),
        tabPanel(<span style="color:#e6db74">&#34;tab 2&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>),
        tabPanel(<span style="color:#e6db74">&#34;tab 3&#34;</span>, <span style="color:#e6db74">&#34;contents&#34;</span>)
    )
)</code></pre></div>

<p>タブやナビゲーションバーを用いてダッシュボードを設計する場合は、<code>tabsetPanel</code>や<code>navbarPage</code>よりも、<code>shinydashboard</code>パッケージを用いるのが便利です。</p>

<h3 id="shiny-アプリケーションの共有-またはサービスとしての立ち上げ">Shiny アプリケーションの共有、またはサービスとしての立ち上げ</h3>

<p>RStudioから最も簡単に Shiny アプリケーションを共有する場合、shinyapps.ioがおすすめです。shinyapps.ioを利用する手順は、</p>

<ol>
<li><p><a href="http://shinyapps.ioでアカウントを作成">http://shinyapps.ioでアカウントを作成</a></p></li>

<li><p>RStudioから<code>rsconnect::deployApp(&quot;path&quot;)</code>を実行(pathにはShinyアプリケーションのディレクトリが入ります)</p></li>
</ol>

<p>shinyapps.ioを使わない場合は、AWSなどのサービスを利用して、Shiny Serverを設置することで公開することとなります。</p>

<h3 id="まとめ">まとめ</h3>

<p>Shiny を始めるために最低限必要となる手順について説明しました。インストール作業を終えると、RStudioだけでShinyの開発に十分な機能が揃っています。</p>

<p>UIに配置する入力と出力ウィジェットを決めて、サーバに計算処理を記述します。入出力の関係は、リアクティブプログラミングと呼ばれる形式でリアクティビティを定義します。</p>

<p>配置した入出力ウィジェットは、レイアウト関数により任意の配置が可能です。Shiny はBootstrapで設計されているので、<code>fluidPage</code>のような可変レイアウト用の関数を用いるとブラウザの表示幅ごとにレスポンシブなデザインで表示されます。</p>

<p>Shiny アプリケーションを公開するための第一選択肢が、shinyapps.ioです。2018年2月時点で5個までであれば、無料で公開することができます。AWSなどのクラウドサービスを利用する場合、Shiny Serverを設置することとなります。</p>

<h3 id="最後に">最後に</h3>

<p>Shinyの始め方と、そのシンプルな設計について紹介しました。Rのコーディングだけで、ブラウザ上で動く動的なwebアプリケーションが作れるということで、データを分析するRユーザがShinyを覚えることになるケースが大半だと思います。しかし、それだけでは母集団がRに習熟した人たちだけになってしまい、すそ野が広がっていきません。</p>

<p>HTMLやCSS、JavaScriptを使える人たちが、さらに一歩進んだ分析をwebアプリケーション上に実装したいと思ったときの選択肢として、Shinyが入ってくることを願っています。</p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=%2ftop-page%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=%2ftop-page%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2ftop-page%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=%2ftop-page%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>About</h4>
    <p><em>qhmqk</em>, R user, native Japanese speaker, traveller and also gambler<br><br><a href="/about">Read more →</a></p>
  </section>
  

  
        <section class="sidebar-module">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/top-page/">Shiny app 開発をスタート</a></li>

<li><a href="/function-index/">索引(アルファベット順)</a></li>

<li><a href="/reference/">索引(機能別)</a></li>

<li><a href="/htmloutput/">htmlOutput</a></li>

<li><a href="/imageoutput/">imageOutput</a></li>

    </ol>
  </section>

  

  
  <section class="sidebar-module">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="https://www.r-project.org/">The R Project for Statistical Computing</a></li>
      
      <li><a href="https://www.rstudio.com/">RStudio</a></li>
      
    </ol>
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      © 2018 qhmqk
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>

    <script async type="text/javascript" src="/js/clipboard.min.js"></script>
    <script async type="text/javascript" src="/js/clip.js"></script>

  </body>

</html>
